---
const navItems = [
  { path: '/', name: 'Home', position: '46%' },
  { path: '/about', name: 'About Us', position: '53%' },
  { path: '/product', name: 'Products', position: '62%' },
  { path: '/customer', name: 'Customers', position: '71%' },
  { path: '/contact', name: 'Contact', position: '81%' },
];
---

<header class="w-full h-[100px] fixed top-0 left-0 right-0 bg-white z-50 overflow-hidden font-inter">
  <!-- Background containers -->
  <div class="absolute inset-0">
    <!-- White section - full width on mobile -->
    <div class="absolute top-0 left-0 h-[100px] w-full lg:w-[40%] bg-white">
      <div class="absolute top-0 right-[-50px] h-[100px] w-[100px] bg-white transform origin-top-right -skew-x-[20deg] hidden lg:block"></div>
    </div>
    <!-- Navy blue section - hidden on mobile -->
    <div class="absolute top-0 right-0 h-[100px] w-[60%] bg-primary-1 hidden lg:block">
      <div class="absolute top-0 left-[-50px] h-[100px] w-[100px] bg-primary-1 transform origin-top-left skew-x-[20deg]"></div>
    </div>
  </div>

  <!-- Main content container -->
  <div class="max-w mx-auto px-[5%] h-full relative">
    <!-- Logo and company name -->
    <div class="absolute top-1/2 -translate-y-1/2 flex items-center gap z-20">
      <img 
        src="/images/logo/Color.png" 
        alt="Company Logo" 
        class="h-10 md:h-20 w-auto"
      />
      <h3 class="text-h5 sm:text-h4 md:text-h3 text-primary-1 whitespace-nowrap">
        PT GLOBAL NIAGA SAKTI
      </h3>
    </div>

    <!-- Desktop Navigation -->
    <nav class="hidden lg:block h-full">
      {navItems.map(item => (
        <a 
          href={item.path} 
          class="absolute top-1/2 -translate-y-1/2 text-body1 text-white hover:text-primary-2 transition-colors whitespace-nowrap z-20"
          style={`left: ${item.position}`}
        >
          {item.name}
        </a>
      ))}

      <!-- Language Selector -->
      <div 
        class="absolute top-1/2 -translate-y-1/2"
        style="right: 5%; z-index: 9999;"
        id="languageSelector"
      >
        <button 
          class="h-[40px] w-[90px] px-5 bg-white rounded-md flex items-center justify-between text-body3 md:text-h5 text-primary-1 relative"
          id="languageButton"
        >
          <span id="selectedLang">EN</span>
          <svg 
            class="w-4 h-4 transition-transform"
            id="langArrow"
            viewBox="0 0 24 24" 
            fill="none" 
            stroke="currentColor"
          >
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
          </svg>
        </button>
      </div>

      <!-- Moved dropdown outside header for better positioning -->
      <div 
        class="fixed hidden w-[205px]"
        id="langDropdown"
        style="z-index: 99999;"
      >
        <div class="bg-primary-2 rounded-lg shadow-xl">
          <button 
            class="w-full px-4 py-1 text-left text-body3 md:text-h5 text-white hover:bg-primary-2/80 transition-colors group"
            data-lang="ID"
          >
            <span class="group-data-[selected=true]:underline">Bahasa Indonesia</span>
          </button>
          <div class="w-full h-[1px] bg-white/20"></div>
          <button 
            class="w-full px-4 py-1 text-left text-body3 md:text-h5 text-white hover:bg-primary-2/80 transition-colors group"
            data-lang="EN"
          >
            <span class="group-data-[selected=true]:underline">English</span>
          </button>
        </div>
      </div>
    </nav>

    <!-- Mobile Navigation Button -->
    <button 
      class="lg:hidden absolute right-4 top-1/2 -translate-y-1/2 p-2 rounded-lg bg-primary-1 text-white z-20"
      id="mobileMenuButton"
      aria-label="Toggle menu"
    >
      <svg 
        class="w-6 h-6" 
        fill="none" 
        stroke="currentColor" 
        viewBox="0 0 24 24"
      >
        <path 
          stroke-linecap="round" 
          stroke-linejoin="round" 
          stroke-width="2" 
          d="M4 6h16M4 12h16M4 18h16"
        />
      </svg>
    </button>

    <div 
      class="lg:hidden fixed top-0 right-0 w-1/3 h-full bg-primary-1 z-50 transform translate-x-full transition-transform duration-300 ease-in-out shadow-lg"
      id="mobileMenu"
    >
    <!-- Close button -->
    <button 
      class="absolute top-4 right-4 p-2 text-white"
      id="closeMenuButton"
    >
      <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
      </svg>
    </button>

    <div class="flex flex-col items-start justify-center h-full pl-6">
      <div class="flex flex-col space-y-4 w-full">
        {navItems.map(item => (
          <a 
            href={item.path} 
            class="text-body3 sm:text-body1 text-white hover:text-primary-2 transition-colors w-full"
          >
            {item.name}
          </a>
        ))}
      </div>
      
      <!-- Mobile Language Selector -->
      <div class="w-full pr-6 mt-4">
        <div class="relative">
          <button 
            class="w-full px-4 py-2 bg-white rounded-md flex items-center justify-between text-body3 text-primary-1"
            id="mobileLangButton"
          >
            <span id="selectedMobileLang">EN</span>
            <svg 
              class="w-4 h-4 transition-transform"
              id="mobileLangArrow"
              viewBox="0 0 24 24" 
              fill="none" 
              stroke="currentColor"
            >
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
            </svg>
          </button>
    
          <!-- Mobile Language Dropdown -->
          <div 
            class="hidden absolute w-full mt-1 z-10"
            id="mobileLangDropdown"
          >
            <div class="bg-primary-2 rounded-lg shadow-xl">
              <button 
                class="w-full px-1.5 py-2 text-left text-body3 text-white hover:bg-primary-2/80 transition-colors"
                data-mobile-lang="ID"
              >
                Bahasa Indonesia
              </button>
              <div class="w-full h-[1px] bg-white/20"></div>
              <button 
                class="w-full px-1.5 py-2 text-left text-body3 text-white hover:bg-primary-2/80 transition-colors"
                data-mobile-lang="EN"
              >
                English
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Backdrop -->
  <div 
    class="lg:hidden fixed inset-0 bg-black/50 z-40 hidden transition-opacity duration-300"
    id="menuBackdrop"
  ></div>
  <!-- Horizontal separator line -->
  <div class="absolute bottom-0 left-0 w-full h-[1px] bg-primary-1 shadow-md z-30"></div>
</header>

<div class="h-[100px]"></div>

<script>
  const languageButton = document.getElementById('languageButton');
  const langDropdown = document.getElementById('langDropdown');
  const selectedLang = document.getElementById('selectedLang');
  const langArrow = document.getElementById('langArrow');
  const langButtons = document.querySelectorAll('[data-lang]');

  let isOpen = false;

  // Add positioning logic
  function updateDropdownPosition() {
    const button = document.getElementById('languageButton');
    const dropdown = document.getElementById('langDropdown');
    
    if (button && dropdown) {
      const rect = button.getBoundingClientRect();
      dropdown.style.top = `${rect.bottom + 8}px`;
      dropdown.style.right = '5%';
    }
  }

  languageButton?.addEventListener('click', (e) => {
    e.stopPropagation();
    isOpen = !isOpen;
    langDropdown?.classList.toggle('hidden', !isOpen);
    langArrow?.classList.toggle('rotate-180', isOpen);
    if (isOpen) {
      updateDropdownPosition();
    }
  });

  // Update position on scroll and resize
  window.addEventListener('scroll', () => {
    if (isOpen) {
      updateDropdownPosition();
    }
  });

  window.addEventListener('resize', () => {
    if (isOpen) {
      updateDropdownPosition();
    }
  });

  langButtons.forEach(button => {
    button.addEventListener('click', (e) => {
      e.stopPropagation();
      const lang = (e.currentTarget as HTMLButtonElement).dataset.lang;
      if (selectedLang) {
        if (lang) {
          selectedLang.textContent = lang;
        }
        // Add selected state
        langButtons.forEach(btn => btn.removeAttribute('data-selected'));
        button.setAttribute('data-selected', 'true');
      }
      isOpen = false;
      langDropdown?.classList.add('hidden');
      langArrow?.classList.remove('rotate-180');
    });
  });

  // Close dropdown when clicking outside
  document.addEventListener('click', () => {
    if (isOpen) {
      isOpen = false;
      langDropdown?.classList.add('hidden');
      langArrow?.classList.remove('rotate-180');
    }
  });

  // Mobile menu functionality
  const mobileMenuButton = document.getElementById('mobileMenuButton');
  const closeMenuButton = document.getElementById('closeMenuButton');
  const mobileMenu = document.getElementById('mobileMenu');
  const menuBackdrop = document.getElementById('menuBackdrop');
  const mobileLangButton = document.getElementById('mobileLangButton');
  const mobileLangDropdown = document.getElementById('mobileLangDropdown');
  const mobileLangArrow = document.getElementById('mobileLangArrow');
  const selectedMobileLang = document.getElementById('selectedMobileLang');

  let isMobileMenuOpen = false;
  let isMobileLangOpen = false;

  function openMobileMenu() {
    mobileMenu?.classList.remove('translate-x-full');
    menuBackdrop?.classList.remove('hidden');
    document.body.style.overflow = 'hidden';
    isMobileMenuOpen = true;
  }

  function closeMobileMenu() {
    mobileMenu?.classList.add('translate-x-full');
    menuBackdrop?.classList.add('hidden');
    document.body.style.overflow = '';
    isMobileMenuOpen = false;
    closeMobileLangDropdown();
  }

  function toggleMobileLangDropdown() {
    isMobileLangOpen = !isMobileLangOpen;
    mobileLangDropdown?.classList.toggle('hidden', !isMobileLangOpen);
    mobileLangArrow?.classList.toggle('rotate-180', isMobileLangOpen);
  }

  function closeMobileLangDropdown() {
    isMobileLangOpen = false;
    mobileLangDropdown?.classList.add('hidden');
    mobileLangArrow?.classList.remove('rotate-180');
  }

  mobileMenuButton?.addEventListener('click', openMobileMenu);
  closeMenuButton?.addEventListener('click', closeMobileMenu);
  menuBackdrop?.addEventListener('click', closeMobileMenu);
  mobileLangButton?.addEventListener('click', (e) => {
    e.stopPropagation();
    toggleMobileLangDropdown();
  });

  // Update both mobile and desktop language selectors
  const mobileLangButtons = document.querySelectorAll('[data-mobile-lang]');
  mobileLangButtons.forEach(button => {
    button.addEventListener('click', (e) => {
      const lang = (e.currentTarget as HTMLButtonElement).dataset.mobileLang;
      if (selectedLang && selectedMobileLang && lang) {
        selectedLang.textContent = lang;
        selectedMobileLang.textContent = lang;
        closeMobileLangDropdown();
      }
    });
  });

  // Close dropdowns when clicking outside
  document.addEventListener('click', () => {
    if (isMobileLangOpen) {
      closeMobileLangDropdown();
    }
  });

  // Close menu when clicking menu items
  const mobileMenuItems = mobileMenu?.querySelectorAll('a');
  mobileMenuItems?.forEach(item => {
    item.addEventListener('click', closeMobileMenu);
  });
</script>